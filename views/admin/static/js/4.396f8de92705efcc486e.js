webpackJsonp([4],{Bgj4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),a=n.n(r),i=n("exGp"),o=n.n(i),d=n("Y81h"),s=n.n(d),l=n("TIfe"),f=n("oAV5"),c=n("P9l9"),u={data:function(){return{auth:Object(l.a)(["admin"]),dialogShow:!1,formTitle:"",friendData:[],friendDataLoading:!0,formInfo:{id:0,frindName:"",frindUrl:""},formRule:{frindName:[{required:!0,message:"请输入友情链接名称",trigger:"blur"}],frindUrl:[{required:!0,message:"请输入友情链接地址",trigger:"blur"}]}}},mounted:function(){this.getFriendData()},methods:{getFriendData:function(){var e=this;return o()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.friendDataLoading=!0,s.a.start(),t.next=4,c.a.getfriend();case 4:(n=t.sent).data.forEach(function(e){e.created=Object(f.a)(e.created),e.updated=Object(f.a)(e.updated)}),e.friendData=n.data,e.friendDataLoading=!1,s.a.done();case 9:case"end":return t.stop()}},t,e)}))()},addFriend:function(){this.dialogShow=!0,this.formTitle="新增"},editFriend:function(e){this.dialogShow=!0,this.formTitle="编辑",this.formInfo.id=e._id,this.formInfo.frindName=e.friendName,this.formInfo.frindUrl=e.friendUrl},deleteFriend:function(e){var t=this;this.$MessageBox.confirm("此操作将永久删除, 是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(o()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.a.deleteFriend(e._id);case 2:if(0!==(r=n.sent).code){n.next=14;break}return t.$message({type:"success",message:"删除成功"}),t.dialogShow=!1,s.a.start(),t.friendDataLoading=!0,n.next=10,t.getFriendData();case 10:s.a.done(),t.friendDataLoading=!1,n.next=15;break;case 14:t.$message({type:"info",message:r.msg});case 15:case"end":return n.stop()}},n,t)}))).catch(function(){})},submit:function(){var e=this;return o()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.formInfo.validate(function(){var t=o()(a.a.mark(function t(n){var r,i,o,d;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=26;break}if(e.dialogShow=!1,s.a.start(),e.friendDataLoading=!0,r=void 0,i=e.formInfo.frindName,o=e.formInfo.frindUrl,d=e.formInfo.id,"新增"!==e.formTitle){t.next=14;break}return t.next=11,c.a.addFriend({friendName:i,friendUrl:o});case 11:r=t.sent,t.next=17;break;case 14:return t.next=16,c.a.editFriend({id:d,friendName:i,friendUrl:o});case 16:r=t.sent;case 17:if(0!==r.code){t.next=23;break}return t.next=20,e.getFriendData();case 20:e.$notify({title:"成功",message:r.msg,type:"success"}),t.next=24;break;case 23:e.$notify({title:"失败",message:r.msg,type:"error"});case 24:s.a.done(),e.friendDataLoading=!1;case 26:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friend"},[e.auth?n("el-button",{staticClass:"create_btn",attrs:{type:"primary",size:"small"},on:{click:e.addFriend}},[e._v("添加链接")]):e._e(),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.friendDataLoading,expression:"friendDataLoading"}],staticStyle:{width:"100%"},attrs:{data:e.friendData,border:"","default-sort":{prop:"date",order:"descending"},"element-loading-text":"拼命加载中"}},[n("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"created",label:"创建时间","min-width":"150",sortable:"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"updated",label:"更新时间","min-width":"150",sortable:"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"friendName",label:"链接名称","min-width":"100",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"friendUrl",label:"链接地址","min-width":"300",align:"center"}}),e._v(" "),e.auth?n("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(n){e.editFriend(t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(n){e.deleteFriend(t.row)}}},[e._v("删除")])]}}])}):e._e()],1),e._v(" "),n("el-dialog",{attrs:{title:e.formTitle,visible:e.dialogShow},on:{"update:visible":function(t){e.dialogShow=t}}},[n("el-form",{ref:"formInfo",attrs:{model:e.formInfo,"label-width":"120px",rules:e.formRule}},[n("el-form-item",{attrs:{label:"名称",prop:"frindName"}},[n("el-input",{model:{value:e.formInfo.frindName,callback:function(t){e.$set(e.formInfo,"frindName",t)},expression:"formInfo.frindName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"地址",prop:"frindUrl"}},[n("el-input",{model:{value:e.formInfo.frindUrl,callback:function(t){e.$set(e.formInfo,"frindUrl",t)},expression:"formInfo.frindUrl"}})],1)],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=n("VU/8")(u,m,!1,function(e){n("N64o")},"data-v-bf7342c2",null);t.default=p.exports},N64o:function(e,t){}});